{% extends "layouts/base.html" %}
{% block body_class %}invite{% endblock %}

{% block content %}

<div class="full-width-container status">
  <div class="container">
		<div class="row">
      <div class="two-thirds column">
		    <h3><i class="fa fa-flag" aria-hidden="true"></i> {{ user.first_name }} wird aktiv.</h3>

        <!--p>
          <strong>Danke, dass du dabei bist.</strong> Hier findest du einen Leitfaden für Straßenaktionen. Keine Sorge – alles ganz easy.
        </p-->
        <!-- else -->
          <!--h3><i class="fa fa-flag" aria-hidden="true"></i> Du bist dabei!</h3-->
        <!-- endif -->

        <p>
          {% if is_new %}
            Bisher fehlen leider noch einige fixe Zusagen.<br />
          {% else %}
            <i class="fa fa-user" aria-hidden="true"></i>
            {% if not meetup.is_viable %}
              <strong><!-- todo name -->{{ other_people_string }}</strong> hat auch schon zugesagt und wird
            {% else %}
              <strong><!-- todo name -->{{ other_people_string }}</strong> haben auch schon zugesagt und werden
            {% endif %}
            Flyer und Material mitbringen.<br />
          {% endif %}
          {% if not is_viable %}
            Lade unbedingt noch Leute ein, damit diese Aktion Spaß macht und ein Erfolg wird!
          {% endif %}
        </p>
      </div>
      <div class="one-third column">
        {% include "_meetup_minimal.html" %}
      </div>
    </div>
  </div>

</div>
<div class="container">

	<h3><i class="fa fa-users" aria-hidden="true"></i> Gemeinsam macht’s mehr Spaß.</h3>

  <p>
    Denk mal nach: Welche deiner FreundInnen würden mitkommen?
  </p>

  <h4>Über Social Media</h4>

  <p>
    <a class="button button-primary" id="fb-share" href="#" onclick="return popupCenter(this.href, 'fb-share', 555, 600)"><i class="fa fa-facebook" aria-hidden="true"></i> Lade Freunde per Facebook-Nachricht ein</a>

    <a class="button button-primary" id="tw-share" href="#" onclick="return popupCenter(this.href, 'tw-share', 700, 300)"><i class="fa fa-twitter" aria-hidden="true"></i> Lade Freunde per Tweet ein</a>
  </p>

  <h4>Per E-Mail</h4>

  <p>
    <a class="button button-primary" href="mailto:HIER%20EINSETZEN?subject={{ invite_email_subject|urlencode }}&body={{ invite_email_body|urlencode }}" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i> Lade Freunde per E-Mail ein</a>
  </p>

  <h4>Teile einen Link</h4>

  <input id="invite-url"type="text" value="{{ invite_meetup_url }}" style="min-width:30%" />
  <button class="clipboard" data-clipboard-target="#invite-url"><i class="fa fa-clipboard" aria-hidden="true"></i></button>
  <div id="clipboard-msg"></div>

  <p>
    <br /><br />
    <a id="next-link" href="{% url 'thankyou' meetup_id=meetup.uuid %}">Fertig / Überspringen &raquo;</a>
  </p>

</div>
<script type="text/javascript">

  document.addEventListener("DOMContentLoaded", function(event) { 
    
    // Set up FB share link
    document.getElementById('fb-share').href =
      'https://www.facebook.com/dialog/send?app_id='+1595950890699096+
      '&link='+encodeURIComponent('{{ invite_meetup_url }}')+
      '&redirect_uri='+encodeURIComponent(document.getElementById('next-link').href);

    document.getElementById('tw-share').href =
      'https://twitter.com/intent/tweet?text='+encodeURIComponent(
        '@HIER @FREUNDE @EINSETZEN Kommt ihr am {{ meetup.datetime|date:"D" }} {{ meetup.datetime|date:"j" }}. mit zu einer Aktion für Van der Bellen in {{ meetup.city }}? Weil\'s um was geht: {{ invite_meetup_url }}'
    );

    // Set up clipboard copy button
    var c = new Clipboard('.clipboard');
    var m = document.getElementById('clipboard-msg');
    c.on('success', function(e) {
      m.innerText = 'Link wurde in die Zwischenablage kopiert.'
      //e.clearSelection();
    });

    c.on('error', function(e) {
      m.innerText = 'Bitte manuell kopieren'
    });

  });

  function popupCenter(url, title, w, h) {
    // Fixes dual-screen position                         Most browsers      Firefox
    var dualScreenLeft = window.screenLeft != undefined ? window.screenLeft : screen.left;
    var dualScreenTop = window.screenTop != undefined ? window.screenTop : screen.top;

    var width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : screen.width;
    var height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height;

    var left = ((width / 2) - (w / 2)) + dualScreenLeft;
    var top = ((height / 2) - (h / 2)) + dualScreenTop;
    var newWindow = window.open(url, title, 'scrollbars=yes, width=' + w + ', height=' + h + ', top=' + top + ', left=' + left);

    // Puts focus on the newWindow
    if (window.focus) {
      newWindow.focus();
    }

    return false;
  }
 
</script>
{% endblock %}
